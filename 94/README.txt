It seems that the result from the code has rounding errors. Summing the values in lines 1-13,15 from wrong_result.txt gives the correct result.

I'll fix this in the future.
